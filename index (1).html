<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPAD RELIEF FUND - Signup/Login Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 400px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h2 {
            text-align: center;
        }
        .hidden {
            display: none;
        }
    </style>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCn0WVdF_7wESjPdllx0930wXQqMyfl3TY",
            authDomain: "spad-83ec1.firebaseapp.com",
            projectId: "spad-83ec1",
            storageBucket: "spad-83ec1.appspot.com",
            messagingSenderId: "382491344593",
            appId: "1:382491344593:web:466703c19e55775743cff0",
            measurementId: "G-K3B2HJRHJC"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        function showSignup() {
            document.getElementById('selection-screen').classList.add('hidden');
            document.getElementById('signup-form').classList.remove('hidden');
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('user-details').classList.add('hidden');
        }

        function showLogin() {
            document.getElementById('selection-screen').classList.add('hidden');
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('signup-form').classList.add('hidden');
            document.getElementById('user-details').classList.add('hidden');
        }

        async function signup() {
            const employeeId = document.getElementById('employee-id').value;
            const mobileNumber = document.getElementById('mobile-number').value;
            const dateOfJoining = document.getElementById('date-of-joining').value;
            const pfNumber = document.getElementById('pf-number').value;
            const password = document.getElementById('password').value;

            // Store user data in Firestore
            try {
                await setDoc(doc(db, "users", mobileNumber), {
                    employeeId: employeeId,
                    mobileNumber: mobileNumber,
                    dateOfJoining: dateOfJoining,
                    pfNumber: pfNumber,
                    password: password
                });
                alert('Signup successful! You can now log in.');
                showLogin();
            } catch (error) {
                console.error("Error adding document: ", error);
                alert('Signup failed. Please try again.');
            }
        }

        async function login() {
            const loginMobile = document.getElementById('login-mobile').value;
            const loginPassword = document.getElementById('login-password').value;

            // Retrieve user data from Firestore
            const userDoc = await getDoc(doc(db, "users", loginMobile));

            if (userDoc.exists() && userDoc.data().password === loginPassword) {
                const userDetails = userDoc.data();
                document.getElementById('details').innerText = `Employee ID: ${userDetails.employeeId}\nMobile Number: ${userDetails.mobileNumber}\nDate of Joining: ${userDetails.dateOfJoining}\nPF Number: ${userDetails.pfNumber}`;
                document.getElementById('user-details').classList.remove('hidden');
                document.getElementById('login-form').classList.add('hidden');
            } else {
                alert('Invalid mobile number or password. Redirecting to signup.');
                showSignup();
            }
        }
    </script>
</head>
<body>

<div class="container">
    <h1>SPAD RELIEF FUND</h1>
    <h2 id="form-title">Welcome</h2>
    <div id="selection-screen">
        <h3>Please choose an option:</h3>
        <button onclick="showSignup()">Sign Up</button>
        <button onclick="showLogin()">Log In</button>
    </div>

    <div id="signup-form" class="hidden">
        <h2>Signup</h2>
        <input type="text" id="employee-id" placeholder="Employee ID" required><br><br>
        <input type="text" id="mobile-number" placeholder="Mobile Number" required><br><br>
        <input type="date" id="date-of-joining" required><br><br>
        <input type="text" id="pf-number" placeholder="PF Number" required><br><br>
        <input type="password" id="password" placeholder="Set Password" required><br><br>
        <button onclick="signup()">Sign Up</button>
    </div>

    <div id="login-form" class="hidden">
        <h2>Login</h2>
        <input type="text" id="login-mobile" placeholder="Mobile Number" required><br><br>
        <input type="password" id="login-password" placeholder="Password" required><br><br>
        <button onclick="login()">Login</button>
    </div>

    <div id="user-details" class="hidden">
        <h2>User Details</h2>
        <p id="details"></p>
        <p style="font-weight: bold; background-color: #e0f7fa; padding: 10px; border-radius: 5px;">Premium 500</p>
        <button onclick="makePayment()">Make Payment</button>
        <button onclick="showLogin()">Log Out</button>
    </div>
</div>

</body>
</html>